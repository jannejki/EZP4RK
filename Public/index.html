<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <title>EZ-P4RK</title>
    <link rel="stylesheet" href="index.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">
    <link rel="shortcut icon" href="./images/logo.png" type="image/x-icon">

    <link rel="manifest" crossorigin="use-credentials" href="manifest.json">
    <link rel="apple-touch-icon" href="pwaImages/ios/152.png">
    <meta name="theme-color" content="white" />
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Hello World">
    <meta name="msapplication-TileImage" content="images/hello-icon-144.png">
    <meta name="msapplication-TileColor" content="#FFFFFF">

    <!--------HEADER-------->
    <body>
    <section class="header">
        <nav>
            <a href="index.html"><img src="./images/logo.png" alt=""></a>
            <div class="nav-links" id="navLinks">
                <img class="close" onclick="hideMenu()" src="./images/close.png" alt="close">
                <ul>
                    <li><button onclick="homediv()">HOME</button></li>
                    <li><button onclick="aboutdiv()">ABOUT</button></li>
                    <li><button onclick="botdiv()">CONTACT</button></li>       
                </ul>
            </div>
            <img class="menu" onclick="showMenu()" src="./images/menu.png" alt="menu">
        </nav>
        <div class="text-box">
            <h1>EZ-P4RK</h1>
            <div class="parkingspots">
                <svg class="parking"><g transform="translate(0.000000,294.000000) scale(0.100000,-0.100000)"
                    fill="#ffffff" stroke="none">
                    <path id="Spot1" d="M0 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot2" d="M580 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot3" d="M1160 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot4" d="M1740 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot5" d="M2320 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot6" d="M2900 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot7" d="M3480 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot8" d="M4060 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot9" d="M4640 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot10" d="M5220 2495 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot11" d="M320 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot12" d="M900 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot13" d="M1480 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot14" d="M2060 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot15" d="M2640 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot16" d="M3220 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot17" d="M3800 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot18" d="M4380 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot19" d="M4960 1465 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot20" d="M900 445 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot21" d="M1480 445 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot22" d="M2060 445 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot23" d="M2640 445 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot24" d="M3220 445 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot25" d="M3800 445 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    <path id="Spot26" d="M4380 445 l0 -445 265 0 265 0 0 445 0 445 -265 0 -265 0 0 -445z"/>
                    </g>                   
                </svg>
            </div>
        </div>
    </section>
<!--------ABOUT-------->
    <section id="aboutdiv" class="about">
        <div class="ab">
            <h1>Project Pictures</h1>
            <p> Here are few photos where you can see the progression of our project (hover on the images or if you are on the wesite with phone then click images).</p>
        </div>
        <div class="gallery">
            <div class="container">
                <div class="card">
                    <div class="imgBx">
                        <img src="./images/cameratesting.jpg" alt="cameratesting">
                    </div>
                    <div class="contentBx">
                        <div class="content">
                            <h3>CAMERA TESTING</h3>
                            <p>First glance of the parking lot with our camera!.</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="imgBx">
                        <img src="./images/flowchart.jpg" alt="camera">
                    </div>
                    <div class="contentBx">
                        <div class="content">
                            <h3>FLOWCHART</h3>
                            <p>Creating a draft of the flowchart w/the boijs.</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="imgBx">
                        <img src="./images/raspi testing.jpg" alt="camera">
                    </div>
                    <div class="contentBx">
                        <div class="content">
                            <h3>Raspberry Pi part 1</h3>
                            <p>Getting camera image to Raspberry Pi's Linux.</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="imgBx">
                        <img src="./images/raspi camera.jpg" alt="camera">
                    </div>
                    <div class="contentBx">
                        <div class="content">
                            <h3>Raspberry Pi part 2</h3>
                            <p>Fixed camera image and framerate problems.</p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="imgBx">
                        <img src="./images/joonaslookingjannewondering.jpg" alt="camera">
                    </div>
                    <div class="contentBx">
                        <div class="content">
                            <h3>location for camera</h3>
                            <p>Looking for a good angel to the parking lot for the camera(and Joonas flexing with his climbing skills and superior balance).<p>
                        </div>
                    </div>
                </div>
                <div class="card">
                    <div class="imgBx">
                        <img src="./images/tamperprotectino.jpg" alt="camera">
                    </div>
                    <div class="contentBx">
                        <div class="content">
                            <h3>Security</h3>
                            <p>creating tampering protection by threatening the person who moves our router.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!---FOOTER-->
    <section class="bot" id="botdiv">
        <h1>If you have any questions</h1>
        <a href="mailto:customersupport@ez-p4rk.com?subject=Love the site" class="btn">CONTACT US</a>
    </section>
<!--------SCRIPT-------->
<script>
    var navLinks = document.getElementById("navLinks");
    function showMenu() {
        navLinks.style.right = "0";
    }
    function hideMenu() {
        navLinks.style.right = "-150px";
    }

//smoothscroll
function aboutdiv() {
    var elem = document.getElementById("aboutdiv");
    elem.scrollIntoView({behavior: "smooth", block: "start", inline: "nearest"});;
}

function botdiv() {
    var elem = document.getElementById("botdiv");
    elem.scrollIntoView({behavior: "smooth", block: "start", inline: "nearest"});;
}
function homediv() {
    alert("This is the homepage its just for aesthetics!");
    return false;
}
</script>

<!-- Tää socket.io script pitää olla ennen scriptiä missä käytetää websocketia-->
<script src="https://ezp4rk.ddns.net/socket.io/socket.io.js"></script>
<!--<script src="/socket.io/socket.io.js"></script>-->
<script> 

try {

    const ws  = io();
    
    // websocket kanavat mitä kuunnellaan
    const parkingLotStatus = 'parkingLotStatus';
    const updatedParkingSpot = 'updatedParkingSpot';

    // tää tapahtuu aina kun sivu päivitetään
    ws.on(parkingLotStatus, (message) => {
        console.log('kaikki parkkipaikat: ', message);
        changeColors(message);
    });

    const changeColors = (spots) => {
        for(let spot of spots) {
            const path = document.getElementById(spot.name);
 
                if(spot.fields.state && !spot.fields.inva) {
                    path.setAttribute("fill", "#26A96C");
                } else if(spot.fields.inva && spot.fields.inva) {
                    path.setAttribute("fill", "#0892d0");
                }
                if(!spot.fields.state) {
                    path.setAttribute("fill", "#ff3232");
                }
            }
    }
    // tää tapahtuu aina kun auto tulee tai lähtee parkkipaikalta
    ws.on(updatedParkingSpot, (message) => {
        console.log('päivitetty parkkipaikka: ', message);
        changeColors([message]);
    })
} catch(err) {
    console.warn("Ei nettiä");
}

</script>
<script src="js/main.js"></script>
</body>
</html>
